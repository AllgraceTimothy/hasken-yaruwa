{% extends "base.html" %}
{% load static %}

{% block title %}Pending Applications - Admin Dashboard{% endblock %}

{% block content %}
<div style="
    max-width: 1400px;
    margin: 0 auto;
    padding: 2rem 1rem;
    min-height: 80vh;
">
    <!-- Page Header -->
    <div class="fade-in" style="
        margin-bottom: 2.5rem;
    ">
        <div style="
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        ">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <div style="
                    background: linear-gradient(135deg, #006747 0%, #00563a 100%);
                    color: #FFD700;
                    width: 50px;
                    height: 50px;
                    border-radius: 50%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 1.5rem;
                    font-weight: bold;
                ">üìã</div>
                <div>
                    <h1 style="
                        color: #006747;
                        font-size: 2.2rem;
                        margin-bottom: 0.3rem;
                    ">
                        Pending Applications
                    </h1>
                    <p style="
                        color: #2F4F4F;
                        font-size: 1.1rem;
                        opacity: 0.9;
                    ">
                        Review and process new student applications
                    </p>
                </div>
            </div>
            
            <div style="
                display: flex;
                gap: 1rem;
                align-items: center;
                flex-wrap: wrap;
            ">
                <div style="
                    background-color: #FFF9E6;
                    color: #006747;
                    padding: 0.5rem 1.2rem;
                    border-radius: 20px;
                    font-weight: 600;
                    font-size: 0.9rem;
                    display: flex;
                    align-items: center;
                    gap: 0.5rem;
                ">
                    <span>Total:</span>
                    <span style="
                        background-color: #FFD700;
                        color: #006747;
                        width: 26px;
                        height: 26px;
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-weight: bold;
                    ">{{ applications|length }}</span>
                </div>
                
                <a href="{% url 'admin_dashboard' %}" style="
                    display: inline-flex;
                    align-items: center;
                    gap: 0.5rem;
                    background-color: #E6E6FA;
                    color: #006747;
                    padding: 0.7rem 1.5rem;
                    border-radius: 6px;
                    text-decoration: none;
                    font-weight: 600;
                    font-size: 0.9rem;
                    transition: all 0.3s ease;
                " onmouseover="this.style.backgroundColor='#d9d9f0'; this.style.transform='translateY(-2px)';" 
                onmouseout="this.style.backgroundColor='#E6E6FA'; this.style.transform='translateY(0)';">
                    ‚Üê Back to Dashboard
                </a>
            </div>
        </div>
        
        <!-- Stats Summary -->
        <div style="
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        ">
            <div style="
                background-color: white;
                padding: 1.5rem;
                border-radius: 10px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.05);
                border-left: 4px solid #006747;
            ">
                <div style="
                    font-size: 2rem;
                    font-weight: bold;
                    color: #006747;
                    margin-bottom: 0.5rem;
                ">{{ applications|length }}</div>
                <div style="
                    color: #2F4F4F;
                    font-size: 0.9rem;
                    font-weight: 600;
                ">Pending Review</div>
            </div>
            
            <div style="
                background-color: white;
                padding: 1.5rem;
                border-radius: 10px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.05);
                border-left: 4px solid #FFD700;
            ">
                <div style="
                    font-size: 2rem;
                    font-weight: bold;
                    color: #006747;
                    margin-bottom: 0.5rem;
                ">{{ reviewed_count|default:"0" }}</div>
                <div style="
                    color: #2F4F4F;
                    font-size: 0.9rem;
                    font-weight: 600;
                ">Reviewed Today</div>
            </div>
            
            <div style="
                background-color: white;
                padding: 1.5rem;
                border-radius: 10px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.05);
                border-left: 4px solid #E6E6FA;
            ">
                <div style="
                    font-size: 2rem;
                    font-weight: bold;
                    color: #006747;
                    margin-bottom: 0.5rem;
                ">{{ avg_review_time|default:"48" }}h</div>
                <div style="
                    color: #2F4F4F;
                    font-size: 0.9rem;
                    font-weight: 600;
                ">Avg. Review Time</div>
            </div>
            
            <div style="
                background-color: white;
                padding: 1.5rem;
                border-radius: 10px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.05);
                border-left: 4px solid #2F4F4F;
            ">
                <div style="
                    font-size: 2rem;
                    font-weight: bold;
                    color: #006747;
                    margin-bottom: 0.5rem;
                ">{{ priority_count|default:"0" }}</div>
                <div style="
                    color: #2F4F4F;
                    font-size: 0.9rem;
                    font-weight: 600;
                ">Priority Applications</div>
            </div>
        </div>
    </div>

    <!-- Applications Table -->
    <div class="slide-in-left" style="
        background-color: white;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        overflow: hidden;
        margin-bottom: 2rem;
    ">
        <div style="
            background: linear-gradient(135deg, #006747 0%, #00563a 100%);
            padding: 1.5rem;
            color: white;
        ">
            <div style="
                display: flex;
                justify-content: space-between;
                align-items: center;
                flex-wrap: wrap;
                gap: 1rem;
            ">
                <h2 style="
                    margin: 0;
                    font-size: 1.5rem;
                    display: flex;
                    align-items: center;
                    gap: 0.8rem;
                ">
                    <span style="color: #FFD700;">üë•</span> 
                    Student Applications
                </h2>
                
                <div style="display: flex; gap: 0.8rem; align-items: center;">
                    <button id="selectAllBtn" style="
                        background: rgba(255, 255, 255, 0.1);
                        color: white;
                        border: 1px solid rgba(255, 255, 255, 0.3);
                        padding: 0.5rem 1rem;
                        border-radius: 5px;
                        cursor: pointer;
                        font-size: 0.85rem;
                        transition: all 0.3s ease;
                    " onmouseover="this.style.backgroundColor='rgba(255,255,255,0.2)';" 
                    onmouseout="this.style.backgroundColor='rgba(255,255,255,0.1)';">
                        Select All
                    </button>
                    
                    <div style="position: relative;">
                        <select id="sortSelect" style="
                            background: rgba(255, 255, 255, 0.1);
                            color: white;
                            border: 1px solid rgba(255, 255, 255, 0.3);
                            padding: 0.5rem 2.5rem 0.5rem 1rem;
                            border-radius: 5px;
                            cursor: pointer;
                            font-size: 0.85rem;
                            appearance: none;
                        " onchange="sortApplications()">
                            <option value="newest">Newest First</option>
                            <option value="oldest">Oldest First</option>
                            <option value="name">Name A-Z</option>
                            <option value="priority">Priority First</option>
                        </select>
                        <div style="
                            position: absolute;
                            right: 10px;
                            top: 50%;
                            transform: translateY(-50%);
                            color: white;
                            pointer-events: none;
                        ">‚ñº</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Applications List -->
        <div style="padding: 0;">
            {% if applications %}
            <div style="
                max-height: 600px;
                overflow-y: auto;
                position: relative;
            ">
                <table style="
                    width: 100%;
                    border-collapse: collapse;
                ">
                    <thead style="
                        position: sticky;
                        top: 0;
                        background-color: #F8F9FA;
                        z-index: 10;
                    ">
                        <tr>
                            <th style="
                                padding: 1rem;
                                text-align: left;
                                font-weight: 600;
                                color: #006747;
                                border-bottom: 2px solid #E6E6FA;
                                width: 40px;
                            ">
                                <input type="checkbox" id="masterCheckbox" style="
                                    accent-color: #006747;
                                    cursor: pointer;
                                ">
                            </th>
                            <th style="
                                padding: 1rem;
                                text-align: left;
                                font-weight: 600;
                                color: #006747;
                                border-bottom: 2px solid #E6E6FA;
                            ">Applicant</th>
                            <th style="
                                padding: 1rem;
                                text-align: left;
                                font-weight: 600;
                                color: #006747;
                                border-bottom: 2px solid #E6E6FA;
                            ">Location</th>
                            <th style="
                                padding: 1rem;
                                text-align: left;
                                font-weight: 600;
                                color: #006747;
                                border-bottom: 2px solid #E6E6FA;
                            ">School</th>
                            <th style="
                                padding: 1rem;
                                text-align: left;
                                font-weight: 600;
                                color: #006747;
                                border-bottom: 2px solid #E6E6FA;
                            ">Submitted</th>
                            <th style="
                                padding: 1rem;
                                text-align: left;
                                font-weight: 600;
                                color: #006747;
                                border-bottom: 2px solid #E6E6FA;
                            ">Status</th>
                            <th style="
                                padding: 1rem;
                                text-align: left;
                                font-weight: 600;
                                color: #006747;
                                border-bottom: 2px solid #E6E6FA;
                            ">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for app in applications %}
                        <tr data-application-id="{{ app.id }}" 
                            data-submitted="{{ app.created_at|date:'U' }}" 
                            data-priority="{{ app.priority|default:'normal' }}"
                            style="
                                border-bottom: 1px solid #E6E6FA;
                                transition: background-color 0.2s ease;
                            " onmouseover="this.style.backgroundColor='#F8F9FA';" 
                            onmouseout="this.style.backgroundColor='white';">
                            <td style="padding: 1rem;">
                                <input type="checkbox" class="app-checkbox" data-app-id="{{ app.id }}" style="
                                    accent-color: #006747;
                                    cursor: pointer;
                                ">
                            </td>
                            <td style="padding: 1rem;">
                                <div style="
                                    display: flex;
                                    align-items: center;
                                    gap: 1rem;
                                ">
                                    <div style="
                                        width: 40px;
                                        height: 40px;
                                        background-color: #E6E6FA;
                                        color: #006747;
                                        border-radius: 50%;
                                        display: flex;
                                        align-items: center;
                                        justify-content: center;
                                        font-weight: bold;
                                        font-size: 1.1rem;
                                    ">
                                        {{ app.full_name|slice:":1"|upper }}
                                    </div>
                                    <div>
                                        <div style="
                                            color: #006747;
                                            font-weight: 600;
                                            margin-bottom: 0.2rem;
                                        ">
                                            {{ app.full_name }}
                                        </div>
                                        <div style="
                                            color: #2F4F4F;
                                            font-size: 0.85rem;
                                            opacity: 0.8;
                                        ">
                                            Age: {{ app.age|default:"Not specified" }}
                                        </div>
                                    </div>
                                </div>
                            </td>
                            <td style="padding: 1rem;">
                                <div style="color: #2F4F4F;">
                                    {{ app.location|default:"Not specified" }}
                                </div>
                                {% if app.priority == 'high' %}
                                <span style="
                                    display: inline-block;
                                    background-color: #FFE6E6;
                                    color: #D32F2F;
                                    padding: 0.2rem 0.6rem;
                                    border-radius: 12px;
                                    font-size: 0.75rem;
                                    font-weight: 600;
                                    margin-top: 0.3rem;
                                ">Urgent Area</span>
                                {% endif %}
                            </td>
                            <td style="padding: 1rem;">
                                <div style="color: #2F4F4F;">
                                    {{ app.school_name|default:"Not specified"|truncatechars:25 }}
                                </div>
                            </td>
                            <td style="padding: 1rem;">
                                <div style="color: #2F4F4F;">
                                    {{ app.created_at|date:"M d, Y" }}
                                </div>
                                <div style="
                                    color: #2F4F4F;
                                    font-size: 0.85rem;
                                    opacity: 0.7;
                                ">
                                    {{ app.created_at|timesince }} ago
                                </div>
                            </td>
                            <td style="padding: 1rem;">
                                {% if app.priority == 'high' %}
                                <span style="
                                    display: inline-flex;
                                    align-items: center;
                                    gap: 0.3rem;
                                    background-color: #FFF9E6;
                                    color: #FF9800;
                                    padding: 0.4rem 0.8rem;
                                    border-radius: 15px;
                                    font-size: 0.8rem;
                                    font-weight: 600;
                                ">
                                    <span>‚ö†Ô∏è</span> Priority
                                </span>
                                {% else %}
                                <span style="
                                    display: inline-flex;
                                    align-items: center;
                                    gap: 0.3rem;
                                    background-color: #E6F0FA;
                                    color: #006747;
                                    padding: 0.4rem 0.8rem;
                                    border-radius: 15px;
                                    font-size: 0.8rem;
                                    font-weight: 600;
                                ">
                                    <span>‚è≥</span> Pending
                                </span>
                                {% endif %}
                            </td>
                            <td style="padding: 1rem;">
                                <div style="display: flex; gap: 0.5rem;">
                                    <a href="{% url 'review_application_detail' app.id %}" style="
                                        display: inline-flex;
                                        align-items: center;
                                        gap: 0.3rem;
                                        background-color: #006747;
                                        color: white;
                                        padding: 0.5rem 1rem;
                                        border-radius: 5px;
                                        text-decoration: none;
                                        font-weight: 600;
                                        font-size: 0.85rem;
                                        transition: all 0.3s ease;
                                    " onmouseover="this.style.backgroundColor='#00563a'; this.style.transform='translateY(-1px)';" 
                                    onmouseout="this.style.backgroundColor='#006747'; this.style.transform='translateY(0)';">
                                        Review
                                        <span style="font-size: 1.1rem;">‚Üí</span>
                                    </a>
                                    
                                    <button class="quick-view-btn" data-app-id="{{ app.id }}" style="
                                        background-color: #E6E6FA;
                                        color: #006747;
                                        border: none;
                                        padding: 0.5rem 0.8rem;
                                        border-radius: 5px;
                                        cursor: pointer;
                                        font-size: 0.85rem;
                                        font-weight: 600;
                                        transition: all 0.3s ease;
                                    " onmouseover="this.style.backgroundColor='#d9d9f0'; this.style.transform='translateY(-1px)';" 
                                    onmouseout="this.style.backgroundColor='#E6E6FA'; this.style.transform='translateY(0)';">
                                        Quick View
                                    </button>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            
            <!-- Bulk Actions -->
            <div style="
                padding: 1.5rem;
                background-color: #F8F9FA;
                border-top: 1px solid #E6E6FA;
                display: flex;
                justify-content: space-between;
                align-items: center;
                flex-wrap: wrap;
                gap: 1rem;
            ">
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <span id="selectedCount" style="
                        color: #2F4F4F;
                        font-size: 0.9rem;
                        font-weight: 600;
                    ">
                        0 applications selected
                    </span>
                </div>
                
                <div style="display: flex; gap: 0.8rem; flex-wrap: wrap;">
                    <select id="bulkAction" style="
                        padding: 0.5rem 1rem;
                        border: 1px solid #E6E6FA;
                        border-radius: 5px;
                        background-color: white;
                        color: #2F4F4F;
                        font-size: 0.9rem;
                        min-width: 150px;
                    ">
                        <option value="">Bulk Actions</option>
                        <option value="approve">Approve Selected</option>
                        <option value="request_info">Request More Info</option>
                        <option value="mark_reviewed">Mark as Reviewed</option>
                        <option value="assign">Assign to Team Member</option>
                    </select>
                    
                    <button id="applyBulkAction" disabled style="
                        background-color: #006747;
                        color: white;
                        border: none;
                        padding: 0.5rem 1.5rem;
                        border-radius: 5px;
                        cursor: pointer;
                        font-weight: 600;
                        font-size: 0.9rem;
                        transition: all 0.3s ease;
                        opacity: 0.5;
                    " onmouseover="if(!this.disabled) this.style.backgroundColor='#00563a';" 
                    onmouseout="this.style.backgroundColor='#006747';">
                        Apply
                    </button>
                </div>
            </div>
            
            <!-- Pagination -->
            <div style="
                padding: 1.5rem;
                border-top: 1px solid #E6E6FA;
                display: flex;
                justify-content: space-between;
                align-items: center;
                flex-wrap: wrap;
                gap: 1rem;
            ">
                <div style="color: #2F4F4F; font-size: 0.9rem;">
                    Showing {{ applications|length }} of {{ total_count|default:applications|length }} applications
                </div>
                
                <div style="display: flex; gap: 0.5rem;">
                    <button style="
                        background-color: white;
                        border: 1px solid #E6E6FA;
                        color: #2F4F4F;
                        padding: 0.5rem 1rem;
                        border-radius: 5px;
                        cursor: pointer;
                        font-size: 0.9rem;
                        transition: all 0.3s ease;
                    " onmouseover="this.style.borderColor='#006747'; this.style.color='#006747';" 
                    onmouseout="this.style.borderColor='#E6E6FA'; this.style.color='#2F4F4F';">
                        ‚Üê Previous
                    </button>
                    
                    <button style="
                        background-color: #006747;
                        border: 1px solid #006747;
                        color: white;
                        padding: 0.5rem 1rem;
                        border-radius: 5px;
                        cursor: pointer;
                        font-size: 0.9rem;
                        font-weight: 600;
                        transition: all 0.3s ease;
                    " onmouseover="this.style.backgroundColor='#00563a';" 
                    onmouseout="this.style.backgroundColor='#006747';">
                        1
                    </button>
                    
                    <button style="
                        background-color: white;
                        border: 1px solid #E6E6FA;
                        color: #2F4F4F;
                        padding: 0.5rem 1rem;
                        border-radius: 5px;
                        cursor: pointer;
                        font-size: 0.9rem;
                        transition: all 0.3s ease;
                    " onmouseover="this.style.borderColor='#006747'; this.style.color='#006747';" 
                    onmouseout="this.style.borderColor='#E6E6FA'; this.style.color='#2F4F4F';">
                        2
                    </button>
                    
                    <button style="
                        background-color: white;
                        border: 1px solid #E6E6FA;
                        color: #2F4F4F;
                        padding: 0.5rem 1rem;
                        border-radius: 5px;
                        cursor: pointer;
                        font-size: 0.9rem;
                        transition: all 0.3s ease;
                    " onmouseover="this.style.borderColor='#006747'; this.style.color='#006747';" 
                    onmouseout="this.style.borderColor='#E6E6FA'; this.style.color='#2F4F4F';">
                        Next ‚Üí
                    </button>
                </div>
            </div>
            
            {% else %}
            <!-- Empty State -->
            <div style="
                padding: 4rem 2rem;
                text-align: center;
                color: #2F4F4F;
            ">
                <div style="
                    font-size: 4rem;
                    color: #E6E6FA;
                    margin-bottom: 1.5rem;
                ">üìã</div>
                <h3 style="
                    color: #006747;
                    font-size: 1.5rem;
                    margin-bottom: 1rem;
                ">
                    No Pending Applications
                </h3>
                <p style="
                    color: #2F4F4F;
                    font-size: 1.1rem;
                    max-width: 500px;
                    margin: 0 auto 2rem;
                    line-height: 1.6;
                ">
                    All applications have been reviewed! Check back later for new submissions.
                </p>
                <div style="display: flex; gap: 1rem; justify-content: center;">
                    <a href="{% url 'admin_dashboard' %}" style="
                        display: inline-flex;
                        align-items: center;
                        gap: 0.5rem;
                        background-color: #006747;
                        color: white;
                        padding: 0.8rem 1.5rem;
                        border-radius: 6px;
                        text-decoration: none;
                        font-weight: 600;
                        transition: all 0.3s ease;
                    " onmouseover="this.style.backgroundColor='#00563a'; this.style.transform='translateY(-2px)';" 
                    onmouseout="this.style.backgroundColor='#006747'; this.style.transform='translateY(0)';">
                        ‚Üê Return to Dashboard
                    </a>
                    
                    <button onclick="location.reload()" style="
                        display: inline-flex;
                        align-items: center;
                        gap: 0.5rem;
                        background-color: #E6E6FA;
                        color: #006747;
                        border: none;
                        padding: 0.8rem 1.5rem;
                        border-radius: 6px;
                        cursor: pointer;
                        font-weight: 600;
                        transition: all 0.3s ease;
                    " onmouseover="this.style.backgroundColor='#d9d9f0'; this.style.transform='translateY(-2px)';" 
                    onmouseout="this.style.backgroundColor='#E6E6FA'; this.style.transform='translateY(0)';">
                        üîÑ Refresh
                    </button>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
    
    <!-- Quick Stats & Actions -->
    <div class="slide-in-right" style="
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
        margin-top: 2rem;
    ">
        <!-- Review Guidelines -->
        <div style="
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            padding: 2rem;
        ">
            <h3 style="
                color: #006747;
                font-size: 1.3rem;
                margin-bottom: 1.5rem;
                display: flex;
                align-items: center;
                gap: 0.8rem;
            ">
                <span style="color: #FFD700;">üìù</span> Review Guidelines
            </h3>
            
            <ul style="
                color: #2F4F4F;
                line-height: 1.6;
                padding-left: 1.2rem;
                margin: 0;
            ">
                <li style="margin-bottom: 0.8rem;">
                    <strong style="color: #006747;">Check completeness:</strong> 
                    All required fields should be filled
                </li>
                <li style="margin-bottom: 0.8rem;">
                    <strong style="color: #006747;">Verify contact info:</strong> 
                    Parent/guardian details must be valid
                </li>
                <li style="margin-bottom: 0.8rem;">
                    <strong style="color: #006747;">Assess need:</strong> 
                    Review personal story and challenges
                </li>
                <li style="margin-bottom: 0.8rem;">
                    <strong style="color: #006747;">Priority check:</strong> 
                    Flag urgent cases (orphans, special needs)
                </li>
                <li>
                    <strong style="color: #006747;">Document decisions:</strong> 
                    Add notes for transparency
                </li>
            </ul>
        </div>
        
        <!-- Export Options -->
        <div style="
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            padding: 2rem;
        ">
            <h3 style="
                color: #006747;
                font-size: 1.3rem;
                margin-bottom: 1.5rem;
                display: flex;
                align-items: center;
                gap: 0.8rem;
            ">
                <span style="color: #FFD700;">üì§</span> Export & Reports
            </h3>
            
            <div style="
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 1rem;
                margin-bottom: 1.5rem;
            ">
                <button onclick="exportData('csv')" style="
                    background-color: #E6F0FA;
                    color: #006747;
                    border: 1px solid #E6F0FA;
                    padding: 0.8rem;
                    border-radius: 8px;
                    cursor: pointer;
                    font-weight: 600;
                    font-size: 0.9rem;
                    transition: all 0.3s ease;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 0.5rem;
                " onmouseover="this.style.backgroundColor='#d0e4f5'; this.style.transform='translateY(-2px)';" 
                onmouseout="this.style.backgroundColor='#E6F0FA'; this.style.transform='translateY(0)';">
                    üìÑ CSV
                </button>
                
                <button onclick="exportData('pdf')" style="
                    background-color: #FFE6E6;
                    color: #D32F2F;
                    border: 1px solid #FFE6E6;
                    padding: 0.8rem;
                    border-radius: 8px;
                    cursor: pointer;
                    font-weight: 600;
                    font-size: 0.9rem;
                    transition: all 0.3s ease;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 0.5rem;
                " onmouseover="this.style.backgroundColor='#f5d0d0'; this.style.transform='translateY(-2px)';" 
                onmouseout="this.style.backgroundColor='#FFE6E6'; this.style.transform='translateY(0)';">
                    üìä PDF
                </button>
                
                <button onclick="exportData('excel')" style="
                    background-color: #E6FAF0;
                    color: #2E7D32;
                    border: 1px solid #E6FAF0;
                    padding: 0.8rem;
                    border-radius: 8px;
                    cursor: pointer;
                    font-weight: 600;
                    font-size: 0.9rem;
                    transition: all 0.3s ease;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 0.5rem;
                " onmouseover="this.style.backgroundColor='#d0f5e0'; this.style.transform='translateY(-2px)';" 
                onmouseout="this.style.backgroundColor='#E6FAF0'; this.style.transform='translateY(0)';">
                    üìà Excel
                </button>
                
                <button onclick="printReport()" style="
                    background-color: #FFF9E6;
                    color: #FF9800;
                    border: 1px solid #FFF9E6;
                    padding: 0.8rem;
                    border-radius: 8px;
                    cursor: pointer;
                    font-weight: 600;
                    font-size: 0.9rem;
                    transition: all 0.3s ease;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 0.5rem;
                " onmouseover="this.style.backgroundColor='#f5f0d0'; this.style.transform='translateY(-2px)';" 
                onmouseout="this.style.backgroundColor='#FFF9E6'; this.style.transform='translateY(0)';">
                    üñ®Ô∏è Print
                </button>
            </div>
            
            <div style="
                background-color: #F8F9FA;
                padding: 1rem;
                border-radius: 8px;
                text-align: center;
            ">
                <p style="
                    color: #2F4F4F;
                    margin: 0;
                    font-size: 0.85rem;
                    line-height: 1.4;
                ">
                    <strong style="color: #006747;">Last export:</strong> 
                    {% now "F j, Y" %} at {% now "g:i A" %}
                </p>
            </div>
        </div>
    </div>
</div>

<!-- Quick View Modal -->
<div id="quickViewModal" style="
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    padding: 1rem;
">
    <div style="
        background-color: white;
        border-radius: 12px;
        padding: 2rem;
        max-width: 500px;
        width: 100%;
        max-height: 80vh;
        overflow-y: auto;
        position: relative;
        animation: modalSlideIn 0.3s ease-out;
    ">
        <button id="closeQuickView" style="
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #2F4F4F;
            cursor: pointer;
            padding: 0.5rem;
        ">√ó</button>
        
        <div id="quickViewContent">
            <!-- Content will be loaded here -->
        </div>
    </div>
</div>

<!-- JavaScript -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Checkbox selection logic
        const masterCheckbox = document.getElementById('masterCheckbox');
        const appCheckboxes = document.querySelectorAll('.app-checkbox');
        const selectedCountEl = document.getElementById('selectedCount');
        const applyBulkActionBtn = document.getElementById('applyBulkAction');
        const selectAllBtn = document.getElementById('selectAllBtn');
        
        function updateSelectedCount() {
            const selected = document.querySelectorAll('.app-checkbox:checked');
            selectedCountEl.textContent = `${selected.length} application${selected.length !== 1 ? 's' : ''} selected`;
            
            // Enable/disable bulk action button
            applyBulkActionBtn.disabled = selected.length === 0;
            applyBulkActionBtn.style.opacity = selected.length === 0 ? '0.5' : '1';
        }
        
        // Master checkbox
        if (masterCheckbox) {
            masterCheckbox.addEventListener('change', function() {
                appCheckboxes.forEach(checkbox => {
                    checkbox.checked = this.checked;
                });
                updateSelectedCount();
            });
        }
        
        // Select All button
        if (selectAllBtn) {
            selectAllBtn.addEventListener('click', function() {
                const allChecked = Array.from(appCheckboxes).every(cb => cb.checked);
                appCheckboxes.forEach(checkbox => {
                    checkbox.checked = !allChecked;
                });
                if (masterCheckbox) {
                    masterCheckbox.checked = !allChecked;
                }
                updateSelectedCount();
            });
        }
        
        // Individual checkboxes
        appCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                updateSelectedCount();
                
                // Update master checkbox
                if (masterCheckbox) {
                    const allChecked = Array.from(appCheckboxes).every(cb => cb.checked);
                    const anyChecked = Array.from(appCheckboxes).some(cb => cb.checked);
                    masterCheckbox.checked = allChecked;
                    masterCheckbox.indeterminate = anyChecked && !allChecked;
                }
            });
        });
        
        // Bulk actions
        if (applyBulkActionBtn) {
            applyBulkActionBtn.addEventListener('click', function() {
                const selected = document.querySelectorAll('.app-checkbox:checked');
                const action = document.getElementById('bulkAction').value;
                
                if (selected.length === 0 || !action) {
                    alert('Please select applications and choose an action.');
                    return;
                }
                
                const appIds = Array.from(selected).map(cb => cb.dataset.appId);
                
                // Show confirmation
                if (confirm(`Apply "${action}" to ${selected.length} selected application${selected.length !== 1 ? 's' : ''}?`)) {
                    // Simulate API call
                    applyBulkActionBtn.innerHTML = 'Processing...';
                    applyBulkActionBtn.disabled = true;
                    
                    setTimeout(() => {
                        alert(`Successfully applied "${action}" to ${selected.length} application${selected.length !== 1 ? 's' : ''}.`);
                        applyBulkActionBtn.innerHTML = 'Apply';
                        applyBulkActionBtn.disabled = false;
                        
                        // Clear selection
                        selected.forEach(cb => cb.checked = false);
                        updateSelectedCount();
                    }, 1500);
                }
            });
        }
        
        // Quick View Modal
        const quickViewModal = document.getElementById('quickViewModal');
        const quickViewContent = document.getElementById('quickViewContent');
        const closeQuickView = document.getElementById('closeQuickView');
        
        document.querySelectorAll('.quick-view-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const appId = this.dataset.appId;
                
                // Simulate loading application data
                quickViewContent.innerHTML = `
                    <div style="text-align: center; padding: 2rem;">
                        <div class="spinner" style="
                            width: 40px;
                            height: 40px;
                            border: 3px solid #E6E6FA;
                            border-top-color: #006747;
                            border-radius: 50%;
                            animation: spin 1s linear infinite;
                            margin: 0 auto 1rem;
                        "></div>
                        <p>Loading application details...</p>
                    </div>
                `;
                
                quickViewModal.style.display = 'flex';
                
                // Simulate API call
                setTimeout(() => {
                    quickViewContent.innerHTML = `
                        <h3 style="color: #006747; margin-bottom: 1.5rem; font-size: 1.4rem;">
                            Application Preview
                        </h3>
                        
                        <div style="margin-bottom: 1.5rem;">
                            <div style="
                                display: flex;
                                align-items: center;
                                gap: 1rem;
                                margin-bottom: 1rem;
                            ">
                                <div style="
                                    width: 50px;
                                    height: 50px;
                                    background-color: #E6E6FA;
                                    color: #006747;
                                    border-radius: 50%;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    font-weight: bold;
                                    font-size: 1.2rem;
                                ">A</div>
                                <div>
                                    <div style="color: #006747; font-weight: 600; font-size: 1.1rem;">
                                        Applicant Name
                                    </div>
                                    <div style="color: #2F4F4F; font-size: 0.9rem;">
                                        Application ID: #${appId}
                                    </div>
                                </div>
                            </div>
                            
                            <div style="
                                background-color: #F8F9FA;
                                padding: 1rem;
                                border-radius: 8px;
                                margin-bottom: 1rem;
                            ">
                                <div style="
                                    display: grid;
                                    grid-template-columns: 1fr 1fr;
                                    gap: 0.8rem;
                                    font-size: 0.9rem;
                                ">
                                    <div>
                                        <div style="color: #2F4F4F; opacity: 0.7; font-size: 0.8rem;">Age</div>
                                        <div style="color: #006747; font-weight: 600;">16</div>
                                    </div>
                                    <div>
                                        <div style="color: #2F4F4F; opacity: 0.7; font-size: 0.8rem;">Location</div>
                                        <div style="color: #006747; font-weight: 600;">Kano State</div>
                                    </div>
                                    <div>
                                        <div style="color: #2F4F4F; opacity: 0.7; font-size: 0.8rem;">School</div>
                                        <div style="color: #006747; font-weight: 600;">Govt Girls Sec. School</div>
                                    </div>
                                    <div>
                                        <div style="color: #2F4F4F; opacity: 0.7; font-size: 0.8rem;">Submitted</div>
                                        <div style="color: #006747; font-weight: 600;">2 days ago</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 1.5rem;">
                                <div style="color: #006747; font-weight: 600; margin-bottom: 0.5rem; font-size: 0.95rem;">
                                    Main Challenge
                                </div>
                                <div style="
                                    background-color: #FFF9E6;
                                    padding: 1rem;
                                    border-radius: 8px;
                                    color: #2F4F4F;
                                    font-size: 0.9rem;
                                    line-height: 1.5;
                                ">
                                    Financial constraints preventing school attendance. Family struggles with tuition and transportation costs.
                                </div>
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 1rem;">
                            <a href="/admin/review/${appId}/" style="
                                flex: 1;
                                background-color: #006747;
                                color: white;
                                text-align: center;
                                padding: 0.8rem;
                                border-radius: 6px;
                                text-decoration: none;
                                font-weight: 600;
                                font-size: 0.9rem;
                                transition: all 0.3s ease;
                            " onmouseover="this.style.backgroundColor='#00563a';" 
                            onmouseout="this.style.backgroundColor='#006747';">
                                Full Review ‚Üí
                            </a>
                            <button onclick="closeModal()" style="
                                background-color: #E6E6FA;
                                color: #006747;
                                border: none;
                                padding: 0.8rem;
                                border-radius: 6px;
                                cursor: pointer;
                                font-weight: 600;
                                font-size: 0.9rem;
                                transition: all 0.3s ease;
                            " onmouseover="this.style.backgroundColor='#d9d9f0';" 
                            onmouseout="this.style.backgroundColor='#E6E6FA';">
                                Close
                            </button>
                        </div>
                    `;
                }, 800);
            });
        });
        
        // Close modal
        function closeModal() {
            quickViewModal.style.display = 'none';
        }
        
        closeQuickView.addEventListener('click', closeModal);
        quickViewModal.addEventListener('click', function(e) {
            if (e.target === quickViewModal) {
                closeModal();
            }
        });
        
        // Export functions
        window.exportData = function(format) {
            const selected = document.querySelectorAll('.app-checkbox:checked');
            const count = selected.length || {{ applications|length }};
            
            alert(`Exporting ${count} applications as ${format.toUpperCase()}...\n\n(Simulation - in production this would generate a download)`);
        };
        
        window.printReport = function() {
            window.print();
        };
        
        // Sort function
        window.sortApplications = function() {
            const sortBy = document.getElementById('sortSelect').value;
            alert(`Sorting applications by: ${sortBy}\n\n(Simulation - in production this would reorder the table)`);
        };
        
        // Add CSS for animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes spin {
                to { transform: rotate(360deg); }
            }
            
            @keyframes modalSlideIn {
                from {
                    opacity: 0;
                    transform: translateY(-20px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            
            /* Custom scrollbar */
            ::-webkit-scrollbar {
                width: 8px;
                height: 8px;
            }
            
            ::-webkit-scrollbar-track {
                background: #f1f1f1;
                border-radius: 4px;
            }
            
            ::-webkit-scrollbar-thumb {
                background: #006747;
                border-radius: 4px;
            }
            
            ::-webkit-scrollbar-thumb:hover {
                background: #00563a;
            }
            
            /* Table row selection */
            tr.selected {
                background-color: #E6F0FA !important;
            }
            
            /* Responsive table */
            @media (max-width: 768px) {
                table {
                    display: block;
                    overflow-x: auto;
                }
                
                .stats-summary {
                    grid-template-columns: 1fr 1fr !important;
                }
                
                .quick-stats {
                    grid-template-columns: 1fr !important;
                }
            }
            
            @media (max-width: 480px) {
                .stats-summary {
                    grid-template-columns: 1fr !important;
                }
                
                .table-actions {
                    flex-direction: column;
                    align-items: stretch !important;
                }
                
                .bulk-actions {
                    flex-direction: column;
                }
            }
        `;
        document.head.appendChild(style);
    });
</script>
{% endblock %}